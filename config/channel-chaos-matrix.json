{
  "updated_at": "2026-03-02T01:09:00Z",
  "scenarios": [
    {
      "id": "single-disconnect-with-fallback",
      "source_candidate": "trace:slack:critical:true",
      "description": "single adapter disconnect still keeps one healthy fallback channel",
      "window_minutes": 30,
      "events": [
        {
          "offset_seconds": -45,
          "channel_id": "slack",
          "event": "channel_disconnected",
          "status": "error",
          "detail": "socket closed"
        },
        {
          "offset_seconds": -30,
          "channel_id": "slack",
          "event": "inbound_received",
          "status": "ok"
        },
        {
          "offset_seconds": -15,
          "channel_id": "telegram",
          "event": "inbound_received",
          "status": "ok"
        }
      ],
      "expect": {
        "status": "critical",
        "min_degraded_channels": 1,
        "min_fallback_candidates": 1,
        "alert_codes": [
          "channel_disconnected",
          "channel_degradation"
        ]
      }
    },
    {
      "id": "all-channels-degraded-no-fallback",
      "description": "all observed channels are degraded and fallback list should stay empty",
      "window_minutes": 30,
      "events": [
        {
          "offset_seconds": -40,
          "channel_id": "slack",
          "event": "channel_disconnected",
          "status": "error",
          "detail": "socket closed"
        },
        {
          "offset_seconds": -30,
          "channel_id": "telegram",
          "event": "agent_process",
          "status": "error",
          "detail": "rate limit"
        },
        {
          "offset_seconds": -20,
          "channel_id": "telegram",
          "event": "agent_process",
          "status": "error",
          "detail": "rate limit"
        },
        {
          "offset_seconds": -10,
          "channel_id": "telegram",
          "event": "agent_process",
          "status": "error",
          "detail": "rate limit"
        }
      ],
      "expect": {
        "status": "critical",
        "min_degraded_channels": 2,
        "max_degraded_channels": 2,
        "min_fallback_candidates": 0,
        "reason_contains": "no healthy fallback",
        "alert_codes": [
          "channel_disconnected",
          "channel_degradation"
        ]
      }
    },
    {
      "id": "error-spike-with-healthy-fallback",
      "source_candidate": "trace:cli:degraded:false",
      "description": "error spike without disconnect should be degraded instead of critical when fallback is healthy",
      "window_minutes": 30,
      "events": [
        {
          "offset_seconds": -40,
          "channel_id": "cli",
          "event": "agent_process",
          "status": "error",
          "detail": "temporary"
        },
        {
          "offset_seconds": -30,
          "channel_id": "cli",
          "event": "agent_process",
          "status": "error",
          "detail": "temporary"
        },
        {
          "offset_seconds": -20,
          "channel_id": "cli",
          "event": "agent_process",
          "status": "ok"
        },
        {
          "offset_seconds": -10,
          "channel_id": "http",
          "event": "inbound_received",
          "status": "ok"
        }
      ],
      "expect": {
        "status": "degraded",
        "min_degraded_channels": 1,
        "max_degraded_channels": 1,
        "min_fallback_candidates": 1,
        "alert_codes": [
          "channel_degradation"
        ]
      }
    },
    {
      "id": "threshold-override-suppresses-low-sample-noise",
      "description": "channel-specific override suppresses low-sample error noise and keeps scenario in monitoring state",
      "window_minutes": 30,
      "events": [
        {
          "offset_seconds": -40,
          "channel_id": "slack",
          "event": "agent_process",
          "status": "error",
          "detail": "retryable"
        },
        {
          "offset_seconds": -25,
          "channel_id": "slack",
          "event": "agent_process",
          "status": "ok"
        },
        {
          "offset_seconds": -10,
          "channel_id": "cli",
          "event": "inbound_received",
          "status": "ok"
        }
      ],
      "thresholds": {
        "default": {
          "min_events": 1,
          "warning_error_rate_threshold": 0.001,
          "critical_error_rate_threshold": 0.5,
          "critical_error_count_threshold": 3,
          "critical_disconnected_threshold": 1
        },
        "overrides": {
          "slack": {
            "min_events": 5,
            "warning_error_rate_threshold": 0.5,
            "critical_error_rate_threshold": 0.8,
            "critical_error_count_threshold": 4,
            "critical_disconnected_threshold": 1
          }
        }
      },
      "expect": {
        "status": "monitoring",
        "max_degraded_channels": 0,
        "min_suppressed_channels": 1,
        "min_fallback_candidates": 1,
        "required_threshold_profile": [
          "channel:slack"
        ]
      }
    }
  ]
}
